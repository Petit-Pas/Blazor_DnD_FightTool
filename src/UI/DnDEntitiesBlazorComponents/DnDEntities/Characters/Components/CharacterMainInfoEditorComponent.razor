@using DnDEntitiesBlazorComponents.DnDEntities.AbilityScores
@using DnDFightTool.Domain.DnDEntities.AttackRolls.ArmorClasses.Validation
@using DnDFightTool.Domain.DnDEntities.Characters
@using DnDFightTool.Domain.DnDEntities.Characters.Validation
@using DnDFightTool.Domain.DnDEntities.HitPoint
@using DnDFightTool.Domain.DnDEntities.HitPoint.Validation
@using MudBlazor
@using Microsoft.AspNetCore.Components.Forms
@using Morris.Blazor.Validation

@if (Character is not null)
{
    <MudForm Model="Character" Validation="@(CharacterValidator.ValidateValue)" @ref="@_form">
        <MudPaper Class="pa-4" Elevation="2" Square>
            <MudGrid>
                <MudItem xs="12">
                    <MudTextField Label="Name" @bind-Value="Character.Name" For="@(() => Character.Name)" Typo="Typo.h5"/>
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudNumericField HideSpinButtons="true" Label="Max HPs" @bind-Value="Character.HitPoints.MaxHps" For="@(() => Character.HitPoints.MaxHps)" Immediate="true" />
                </MudItem>
                <MudItem xs="12" sm="6">
                    <MudNumericField HideSpinButtons="true" Label="HPs" @bind-Value="Character.HitPoints.CurrentHps" For="@(() => Character.HitPoints.CurrentHps)" Immediate="true" />
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudNumericField HideSpinButtons="true" Label="Armor Class" @bind-Value="Character.ArmorClass.BaseArmorClass" For="@(() => Character.ArmorClass.BaseArmorClass)" Immediate="true" />
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudGrid>
                        <MudItem xs="3" sm="3" lg="2">
                            <MudCheckBox @bind-Value="Character.ArmorClass.HasShieldEquipped" CheckedIcon="@Icons.Material.Sharp.Shield" UncheckedIcon="@Icons.Material.Outlined.Shield" Color=Color.Primary/>
                        </MudItem>
                        <MudItem xs="9" sm="9" lg="10">
                            <MudTextField ReadOnly="true" Label="Effective AC" Value="@Character.ArmorClass.EffectiveAC" />
                        </MudItem>
                    </MudGrid>
                </MudItem>
                <MudItem xs="12" sm="4">
                    <MudNumericField HideSpinButtons="true" Label="Shield value" @bind-Value="Character.ArmorClass.ShieldArmorClass" For="@(() => Character.ArmorClass.ShieldArmorClass)" Immediate="true" />
                </MudItem>
            </MudGrid>
        </MudPaper>
    </MudForm>

    <MudButton OnClick="ValidateAsync">
        Validate & Show Errors & Refresh
    </MudButton>
}
